machine:
  environment:
    GO15VENDOREXPERIMENT: 1
    PATH: /home/ubuntu/go/bin:~/bin:$PATH
    GOROOT: /home/ubuntu/go

  post:
    - mkdir -p ~/.go_workspace/src
    - mkdir -p ~/.go_workspace/pkg
    - mkdir -p ~/.go_workspace/bin

    - curl -O https://storage.googleapis.com/golang/go1.5.1.linux-amd64.tar.gz
    - tar -C $HOME -xzf go1.5.1.linux-amd64.tar.gz
    - cp -R * ~/.go_workspace/bin:
        pwd: $HOME/go/bin
    - cp -R * ~/.go_workspace/pkg:
        pwd: $HOME/go/pkg

dependencies:
  override:
    - go version

test:
  override:
    - mkdir -p /home/ubuntu/.go_workspace/src/github.com/shinofara
    - ln -s $HOME/$CIRCLE_PROJECT_REPONAME /home/ubuntu/.go_workspace/src/github.com/shinofara/
    - pwd
    - ls -la $HOME/$CIRCLE_PROJECT_REPONAME
    - echo $HOME/$CIRCLE_PROJECT_REPONAME
    - echo $GOPATH
    - GO15VENDOREXPERIMENT=1 go test